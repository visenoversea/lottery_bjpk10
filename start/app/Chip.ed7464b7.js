import{e as a,r as J,o as p,a as d,d as B,j as re,b as e,K as w,M as L,t as l,U as O,Q as ue,S as pe,u as de,D as fe,s as _e,v as ve,c as V,E as b,V as ge,h as m,W as Q,X as c,m as T,p as U,Y as he,Z,$ as me,a0 as ye,P as xe,a1 as be,a2 as F}from"./main.416dc339.js";import{_ as je}from"./index.5e761a6c.js";const Ce=""+new URL("../img/chip/clock.png",import.meta.url).href,$e=""+new URL("../img/chip/bell.png",import.meta.url).href;const ke=j=>(ue("data-v-60b8c17a"),j=j(),pe(),j),we={class:"s_chip_pop"},Le={class:"s-pop-container g-flex-column"},Ie={class:"quick-list"},Se=ke(()=>e("div",{class:"title"},"\u5207\u6362\u5F69\u79CD",-1)),De=["onClick"],Ge={__name:"ChipPop",emits:["lotterySelected"],setup(j,{expose:I,emit:C}){const S=a([]),q=C,y=a(!1);function f(r){S.value=r,y.value=!0}function g(r){r.status===2?O("\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85\uFF01\uFF01\uFF01"):(q("lotterySelected",r.id),$())}function $(){y.value=!1}return I({onShow:f}),(r,_)=>{const R=J("van-popup");return p(),d("div",we,[B(R,{"safe-area-inset-bottom":"",class:"custom-popup",show:y.value,"onUpdate:show":_[0]||(_[0]=h=>y.value=h),position:"left"},{default:re(()=>[e("div",Le,[e("div",Ie,[Se,(p(!0),d(w,null,L(S.value,h=>(p(),d("div",{class:"quick-item",key:`chips${h}`,onClick:W=>g(h)},l(h.lottery_name+" "+h.name),9,De))),128))])])]),_:1},8,["show"])])}}},Pe=je(Ge,[["__scopeId","data-v-60b8c17a"]]);const Oe={class:"v_chip g-flex-column"},qe={class:"v-chip-head"},Re={class:"v-chip-head-top g-flex-align-center"},Ee=e("i",{class:"iconfont icon-zuojiantou"},null,-1),He=[Ee],Ne={class:"v-chip-head-top-title g-flex-align-center g-flex-justify-center"},Ve=e("i",{class:"iconfont icon-datijilu"},null,-1),Te=[Ve],Ue={class:"lottery-select-wrap g-flex-align-center g-flex-justify-between"},Be=e("div",{class:"label g-flex-align-center"},"\u5207\u6362\u5F69\u79CD",-1),We=e("div",{class:"v-content-right-icon g-flex-align-center"},[e("i",{class:"iconfont icon-you"})],-1),Ae=[Be,We],Me={class:"bet-info g-flex"},ze={class:"bet-info-item"},Ke=e("label",null,"\u4F59\u989D",-1),Qe={class:"bet-info-item"},Ze=e("label",null,"\u4E0B\u6CE8\u91D1\u989D",-1),Fe={class:"bet-info-item"},Je=e("label",null,"\u4ECA\u65E5\u76C8\u4E8F",-1),Xe={class:"v-chip-info"},Ye={class:"lottery-data g-flex-align-center"},et=e("img",{src:Ce,alt:""},null,-1),tt={class:"period"},nt=e("img",{src:$e,alt:""},null,-1),ot={class:"period"},lt={class:"v-chip-content g-flex"},st={class:"play-type"},it=["onClick"],at={class:"type-content"},ct={class:"content-title g-flex-align-center g-flex-justify-center"},rt={class:"nums-wrap"},ut=["onClick"],pt={class:"rate"},dt={class:"v-chip-footer g-flex-align-center"},ft={class:"quick-list g-flex-align-center"},_t=["onClick"],vt={class:"amount"},gt={class:"close g-flex-align-center g-flex-justify-center"},xt={__name:"Chip",setup(j){de();const I=fe(),C=_e(),S=ve.exports.useI18n(),q=V(()=>S.tm("chip")),y=a(!1);let f=b({obj:{lottery:{}}});a();const g=a(),$=a(0);let r=b({id:I.query.id||41,room:I.query.room||1}),_=b({list:[]});function R(t){r.id=t,h()}async function h(){C.loadingShow=!0;const{success:t,data:n}=await he({id:r.id});if(!!t){if(f.obj=n.info,C.loadingShow=!0,n.info.next.lottery_id){let s={type:2,open_expect:n.info.next.open_expect,content:"",content2:""};_.list.unshift(s)}W(),N()}}h();function W(){Z.joinGroup("lotteryRoom"+r.id,t=>{let n={type:2,open_expect:t.openExpect,content:"",content2:""},s=b({type:3,open_expect:t.openExpect,content:`${q.value.yifengpanText}:`,content2:""});if(t.type==1){let o=t,v=Y(t.lotteryPlayed);o.targetObj=v,_.list.unshift(o)}else t.type==2?_.list.unshift(n):t.type==3&&_.list.unshift(s);_.list.length>=1e3&&(_.list=_.list.slice(0,1e3))})}function X(){Z.leaveGroup("lotteryRoom"+r.id)}function Y(t){let n=[];f.obj.lotteryGroupList.forEach(o=>{n=n.concat(o.lotteryPlayedList)});let s=n.find(o=>t.id==o.id);return s?Object.assign(s,t):{id:"",name:"",amount:""}}a(!1),a(!1);let D=a(0),E=b({list:[]}),H=b({obj:{next:{open_expect:"-"}}});const i=V(()=>{if(E.list.length){let t=E.list[0];return t.open_code_arr=t.open_code.split(",").map(n=>Number(n)),t.total=t.open_code_arr.reduce((n,s)=>n+s),t}else return{open_expect:"-",open_code:"",open_code_arr:[],open_time:"",total:0}}),k=a(0),G=a(0);async function N(){const{success:t,data:n}=await me({id:f.obj.lottery_id});!t||(E.list=n.lotteryDataList.map(s=>(s.open_code_arr=s.open_code.split(",").map(o=>Number(o)),s.total=s.open_code_arr.reduce((o,v)=>o+v),s)),H.obj=n.lottery,k.value=n.lottery.next.open_time-n.nowTime-n.lottery.stop_time,G.value=n.lottery.next.open_time-n.nowTime,ee())}let A=a(1);function ee(){D.value&&clearInterval(D.value),D.value=setInterval(()=>{A.value++,A.value%5==0&&N(),k.value>0&&k.value--,G.value>0?G.value--:N()},1e3)}let M=a(null);function te(){M.value.onShow(z.value)}a("ChipCancelPop");const ne=V(()=>u.value.length),u=a([]),oe=t=>{if(t===0||t===3||t===6)return"chip-red";if(t===1||t===4||t===7)return"chip-blue";if(t===2||t===5||t===8)return"chip-green"},le=t=>t<1e3?t:t<1e6?t/1e3+"K":t/1e6+"M",se=t=>u.value.findIndex(s=>t.id==s.id)!=-1,ie=t=>{let n=u.value.findIndex(s=>t.id==s.id);n==-1?u.value.push(t):u.value.splice(n,1),console.log(u.value)},ae=async()=>{if(!g.value){O.fail("\u8BF7\u8F93\u5165\u4E0B\u6CE8\u91D1\u989D");return}if(!u.value.length){O.fail("\u8BF7\u9009\u62E9\u4E0B\u6CE8\u53F7\u7801");return}u.value.length&&u.value.forEach(s=>{s.amount=g.value}),C.loadingShow=!0;const{success:t,data:n}=await ye({amount:g.value,betList:u.value,id:"41",openExpect:H.obj.next.open_expect});!t||(O.success(n.msg),K(),g.value="",u.value=[],resetData(),emits("emitDownOrderSuccess"),onClose())},z=a();async function ce(){const{success:t,data:n}=await xe({id:r.room});!t||(z.value=n.info)}ce();const P=a({}),K=async()=>{console.log(8888);const{success:t,data:n}=await be({id:r.id});!t||(P.value=n.info)};return K(),ge(()=>{clearInterval(D.value),X()}),(t,n)=>{const s=J("van-field");return p(),d("div",Oe,[e("div",qe,[e("div",Re,[e("div",{onClick:n[0]||(n[0]=o=>t.$router.go(-1)),class:"v-chip-head-top-left g-flex-align-center"},He),e("div",Ne,[e("span",null,l(m(f).obj.lottery.name)+" "+l(m(f).obj.name),1)]),e("div",{class:"v-head-right g-flex-align-center",onClick:n[1]||(n[1]=o=>t.$router.push("/mybill"))},Te)]),e("div",Ue,[e("div",{class:"lottery-select g-flex",onClick:te},Ae),e("div",Me,[e("div",ze,[Ke,e("p",null,l(P.value.balance),1)]),e("div",Qe,[Ze,e("p",null,l(P.value.betAmount),1)]),e("div",Fe,[Je,e("p",null,l(P.value.todayWin),1)])])]),e("div",Xe,[e("div",Ye,[et,e("div",tt,l(m(H).obj.next.open_expect)+"\u671F",1),Q(" \u5C01\u76D8 "),e("span",null,l(m(F)(k.value)),1),Q(" \u5F00\u5956 "),e("span",null,l(m(F)(G.value)),1)]),e("div",{class:"lottery-data g-flex-align-center",onClick:n[2]||(n[2]=o=>t.$router.push({path:"/lotteryHistory",query:{id:m(f).obj.lottery_id}}))},[nt,e("div",ot,l(i.value.open_expect)+"\u671F",1),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[0]}`])},l(i.value.open_code.split(",")[0]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[1]}`])},l(i.value.open_code.split(",")[1]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[2]}`])},l(i.value.open_code.split(",")[2]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[3]}`])},l(i.value.open_code.split(",")[3]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[4]}`])},l(i.value.open_code.split(",")[4]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[5]}`])},l(i.value.open_code.split(",")[5]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[6]}`])},l(i.value.open_code.split(",")[6]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[7]}`])},l(i.value.open_code.split(",")[7]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[8]}`])},l(i.value.open_code.split(",")[8]),3),e("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[9]}`])},l(i.value.open_code.split(",")[9]),3)])])]),e("div",lt,[e("div",st,[(p(!0),d(w,null,L(m(f).obj.lotteryGroupList,(o,v)=>(p(),d("div",{class:c(["type-item g-flex-align-center g-flex-justify-center",$.value===v?"active":""]),key:`room${o.id}`,onClick:x=>$.value=v},l(o.name),11,it))),128))]),e("div",at,[(p(!0),d(w,null,L(m(f).obj.lotteryGroupList,(o,v)=>T((p(),d("div",{class:"content-item",key:`type${o.id}`},[e("div",ct,l(o.name),1),e("div",rt,[(p(!0),d(w,null,L(o.lotteryPlayedList,x=>(p(),d("div",{class:c(["num-item g-flex-align-center g-flex-justify-center",se(x)?"active":""]),key:`num${x.id}`,onClick:ht=>ie(x)},[e("div",{class:c(["num g-flex-align-center g-flex-justify-center",`number${x.name}`])},l(x.name),3),e("div",pt,l(x.odds),1)],10,ut))),128))])])),[[U,$.value===v]])),128))])]),e("div",dt,[T(e("div",ft,[(p(!0),d(w,null,L(m(f).obj.quickList,(o,v)=>(p(),d("div",{class:c([oe(v),"quick-item g-flex-align-center g-flex-justify-center"]),key:`chips${o}`,onClick:x=>g.value=o},l(le(o)),11,_t))),128))],512),[[U,y.value]]),e("div",vt,[e("p",null,"\u5DF2\u9009\u4E2D"+l(ne.value)+"\u6CE8",1),B(s,{class:"chip-amount",modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=o=>g.value=o),label:"","label-width":"0",placeholder:"\u8BF7\u8F93\u5165\u91D1\u989D"},null,8,["modelValue"])]),e("div",{class:"foot-btn btn-green g-flex-align-center g-flex-justify-center",onClick:ae}," \u4E0B\u6CE8 "),e("div",{class:"foot-btn btn-red g-flex-align-center g-flex-justify-center",onClick:n[4]||(n[4]=o=>y.value=!y.value)}," \u7B79\u7801 "),e("div",{class:"foot-btn btn-blue g-flex-align-center g-flex-justify-center",onClick:n[5]||(n[5]=o=>u.value=[])}," \u91CD\u7F6E "),T(e("div",gt," \u5DF2\u5C01\u76D8 ",512),[[U,k.value<1]])]),B(Pe,{ref_key:"refChipPop",ref:M,onLotterySelected:R},null,512)])}}};export{xt as default};
