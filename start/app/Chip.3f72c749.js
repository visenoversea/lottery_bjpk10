import{_ as pe,g as r,u as Y,c as E,r as W,o as v,a as g,e as H,k as de,b as e,t as l,d as o,M as I,N as S,Q as A,f as fe,E as _e,s as ve,F as $,X as ge,Y as J,Z as p,p as B,v as U,$ as me,a0 as K,a1 as he,a2 as ye,P as xe,a3 as be,a4 as X}from"./main.eeabd2a7.js";const je=""+new URL("../img/chip/clock.png",import.meta.url).href,Ce=""+new URL("../img/chip/bell.png",import.meta.url).href;const $e={class:"s_chip_pop"},ke={class:"s-pop-container g-flex-column"},we={class:"quick-list"},Le={class:"title"},Ie=["onClick"],Se={__name:"ChipPop",emits:["lotterySelected"],setup(ee,{expose:D,emit:k}){const P=r([]),a=Y(),b=E(()=>a.tm("chip")),u=r(!1);function m(d){P.value=d,u.value=!0}function w(d){d.status===2?A(b.value.noOpen):(k("lotterySelected",d.id),h())}function h(){u.value=!1}return D({onShow:m}),(d,G)=>{const O=W("van-popup");return v(),g("div",$e,[H(O,{"safe-area-inset-bottom":"",class:"custom-popup",show:u.value,"onUpdate:show":G[0]||(G[0]=y=>u.value=y),position:"left"},{default:de(()=>[e("div",ke,[e("div",we,[e("div",Le,l(o(b).switch),1),(v(!0),g(I,null,S(P.value,y=>(v(),g("div",{class:"quick-item",key:`chips${y}`,onClick:z=>w(y)},l(y.lottery_name+" "+y.name),9,Ie))),128))])])]),_:1},8,["show"])])}}},De=pe(Se,[["__scopeId","data-v-1f535015"]]);const Pe={class:"v_chip g-flex-column"},Ge={class:"v-chip-head"},Oe={class:"v-chip-head-top g-flex-align-center"},qe=e("i",{class:"iconfont icon-zuojiantou"},null,-1),Re=[qe],Ne={class:"v-chip-head-top-title g-flex-align-center g-flex-justify-center"},Te={class:"head-icon g-flex-align-center"},Ee=e("i",{class:"iconfont icon-datijilu"},null,-1),He=[Ee],Ae={class:"lottery-select-wrap g-flex-align-center g-flex-justify-between"},Ve={class:"label g-flex-align-center"},Be=e("div",{class:"v-content-right-icon g-flex-align-center"},[e("i",{class:"iconfont icon-you"})],-1),Ue={class:"bet-info g-flex"},We={class:"bet-info-item"},ze={class:"bet-info-item"},Me={class:"bet-info-item"},Fe={class:"v-chip-info"},Qe={class:"lottery-data g-flex-align-center"},Ze=e("img",{src:je,alt:""},null,-1),Je={class:"period"},Ke=e("img",{src:Ce,alt:""},null,-1),Xe={class:"period"},Ye={class:"v-chip-content g-flex"},et={class:"play-type"},tt=["onClick"],nt={class:"type-content"},ot={class:"content-title g-flex-align-center g-flex-justify-center"},lt={class:"nums-wrap"},st=["onClick"],it={class:"rate"},ct={class:"v-chip-footer g-flex-align-center"},at={class:"quick-list g-flex-align-center"},rt=["onClick"],ut={class:"amount"},ft={__name:"Chip",setup(ee){fe();const D=_e(),k=ve(),P=Y(),a=E(()=>P.tm("chip")),b=r(!1);let u=$({obj:{lottery:{}}});r();const m=r(),w=r(0);let h=$({id:D.query.id,room:D.query.room}),d=$({list:[]});function G(t){h.id=t,O()}async function O(){k.loadingShow=!0;const{success:t,data:n}=await me({id:h.id});if(!!t){if(u.obj=n.info,k.loadingShow=!0,n.info.next.lottery_id){let s={type:2,open_expect:n.info.next.open_expect,content:"",content2:""};d.list.unshift(s)}y(),N()}}O();function y(){K.joinGroup("lotteryRoom"+h.id,t=>{let n={type:2,open_expect:t.openExpect,content:"",content2:""},s=$({type:3,open_expect:t.openExpect,content:`${a.value.yifengpanText}:`,content2:""});if(t.type==1){let _=t,i=te(t.lotteryPlayed);_.targetObj=i,d.list.unshift(_)}else t.type==2?d.list.unshift(n):t.type==3&&d.list.unshift(s);d.list.length>=1e3&&(d.list=d.list.slice(0,1e3))})}function z(){K.leaveGroup("lotteryRoom"+h.id)}function te(t){let n=[];u.obj.lotteryGroupList.forEach(_=>{n=n.concat(_.lotteryPlayedList)});let s=n.find(_=>t.id==_.id);return s?Object.assign(s,t):{id:"",name:"",amount:""}}r(!1),r(!1);let q=r(0),V=$({list:[]}),j=$({obj:{next:{open_expect:"-"}}});const c=E(()=>{if(V.list.length){let t=V.list[0];return t.open_code_arr=t.open_code.split(",").map(n=>Number(n)),t.total=t.open_code_arr.reduce((n,s)=>n+s),t}else return{open_expect:"-",open_code:"",open_code_arr:[],open_time:"",total:0}}),L=r(0),R=r(0);async function N(){const{success:t,data:n}=await he({id:u.obj.lottery_id});!t||(V.list=n.lotteryDataList.map(s=>(s.open_code_arr=s.open_code.split(",").map(_=>Number(_)),s.total=s.open_code_arr.reduce((_,i)=>_+i),s)),(j.obj.next.open_expect==="-"||j.obj.next.open_expect!==n.lottery.next.open_expect)&&Z(n.lottery.next.open_expect),j.obj=n.lottery,L.value=n.lottery.next.open_time-n.nowTime-n.lottery.stop_time,R.value=n.lottery.next.open_time-n.nowTime,ne())}let M=r(1);function ne(){q.value&&clearInterval(q.value),q.value=setInterval(()=>{M.value++,M.value%5==0&&N(),L.value>0&&L.value--,R.value>0?R.value--:N()},1e3)}let F=r(null);function oe(){F.value.onShow(Q.value)}r("ChipCancelPop");const le=E(()=>f.value.length),f=r([]),se=t=>{if(t===0||t===3||t===6)return"chip-red";if(t===1||t===4||t===7)return"chip-blue";if(t===2||t===5||t===8)return"chip-green"},ie=t=>t<1e3?t:t<1e6?t/1e3+"K":t/1e6+"M",ce=t=>f.value.findIndex(s=>t.id==s.id)!=-1,ae=t=>{let n=f.value.findIndex(s=>t.id==s.id);n==-1?f.value.push(t):f.value.splice(n,1),console.log(f.value)},re=async()=>{if(!m.value){A.fail(a.value.amountPlaceholder);return}if(!f.value.length){A.fail(a.value.betsPlaceholder);return}f.value.length&&f.value.forEach(s=>{s.amount=m.value}),k.loadingShow=!0;const{success:t,data:n}=await ye({amount:m.value,betList:f.value,id:h.id,openExpect:j.obj.next.open_expect});!t||(A.success(n.msg),Z(),m.value="",f.value=[],resetData(),emits("emitDownOrderSuccess"),onClose())},Q=r();async function ue(){const{success:t,data:n}=await xe({id:h.room});!t||(Q.value=n.info)}ue();const T=r({}),Z=async t=>{const{success:n,data:s}=await be({id:h.id,lottery_expect:t||j.obj.next.open_expect});!n||(T.value=s.info)};return ge(()=>{clearInterval(q.value),z()}),(t,n)=>{const s=W("van-icon"),_=W("van-field");return v(),g("div",Pe,[e("div",Ge,[e("div",Oe,[e("div",{onClick:n[0]||(n[0]=i=>t.$router.go(-1)),class:"v-chip-head-top-left g-flex-align-center"},Re),e("div",Ne,[e("span",null,l(o(u).obj.lottery.name)+" "+l(o(u).obj.name),1)]),e("div",Te,[H(s,{onClick:n[1]||(n[1]=i=>N()),color:"#fff",name:"replay",size:"1.5rem"})]),e("div",{class:"v-head-right g-flex-align-center",onClick:n[2]||(n[2]=i=>t.$router.push("/betsrecord"))},He)]),e("div",Ae,[e("div",{class:"lottery-select g-flex",onClick:oe},[e("div",Ve,l(o(a).switch),1),Be]),e("div",Ue,[e("div",We,[e("label",null,l(o(a).balance),1),e("p",null,l(T.value.balance),1)]),e("div",ze,[e("label",null,l(o(a).betAmount),1),e("p",null,l(T.value.betAmount),1)]),e("div",Me,[e("label",null,l(o(a).todayWin),1),e("p",null,l(T.value.todayWin),1)])])]),e("div",Fe,[e("div",Qe,[Ze,e("div",Je,l(o(j).obj.next.open_expect)+"\xA0"+l(o(a).expect),1),J(" "+l(o(a).close)+" ",1),e("span",null,l(o(X)(L.value)),1),J(" "+l(o(a).open)+" ",1),e("span",null,l(o(X)(R.value)),1)]),e("div",{class:"lottery-data g-flex-align-center",onClick:n[3]||(n[3]=i=>t.$router.push({path:"/lotteryHistory",query:{id:o(u).obj.lottery_id}}))},[Ke,e("div",Xe,l(o(c).open_expect)+"\xA0"+l(o(a).expect),1),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[0]}`])},l(o(c).open_code.split(",")[0]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[1]}`])},l(o(c).open_code.split(",")[1]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[2]}`])},l(o(c).open_code.split(",")[2]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[3]}`])},l(o(c).open_code.split(",")[3]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[4]}`])},l(o(c).open_code.split(",")[4]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[5]}`])},l(o(c).open_code.split(",")[5]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[6]}`])},l(o(c).open_code.split(",")[6]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[7]}`])},l(o(c).open_code.split(",")[7]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[8]}`])},l(o(c).open_code.split(",")[8]),3),e("div",{class:p(["number g-flex-align-center g-flex-justify-center",`number${o(c).open_code.split(",")[9]}`])},l(o(c).open_code.split(",")[9]),3)])])]),e("div",Ye,[e("div",et,[(v(!0),g(I,null,S(o(u).obj.lotteryGroupList,(i,C)=>(v(),g("div",{class:p(["type-item g-flex-align-center g-flex-justify-center",w.value===C?"active":""]),key:`room${i.id}`,onClick:x=>w.value=C},l(i.name),11,tt))),128))]),e("div",nt,[(v(!0),g(I,null,S(o(u).obj.lotteryGroupList,(i,C)=>B((v(),g("div",{class:"content-item",key:`type${i.id}`},[e("div",ot,l(i.name),1),e("div",lt,[(v(!0),g(I,null,S(i.lotteryPlayedList,x=>(v(),g("div",{class:p(["num-item g-flex-align-center g-flex-justify-center",ce(x)?"active":""]),key:`num${x.id}`,onClick:pt=>ae(x)},[e("div",{class:p(["num g-flex-align-center g-flex-justify-center",`number${x.name}`])},l(x.name),3),e("div",it,l(x.odds),1)],10,st))),128))])])),[[U,w.value===C]])),128))])]),e("div",ct,[B(e("div",at,[(v(!0),g(I,null,S(o(u).obj.quickList,(i,C)=>(v(),g("div",{class:p([se(C),"quick-item g-flex-align-center g-flex-justify-center"]),key:`chips${i}`,onClick:x=>m.value=i},l(ie(i)),11,rt))),128))],512),[[U,b.value]]),e("div",ut,[e("p",null,l(t.$t("chip.betedText",{num:o(le)})),1),H(_,{class:"chip-amount",modelValue:m.value,"onUpdate:modelValue":n[4]||(n[4]=i=>m.value=i),label:"","label-width":"0",placeholder:o(a).betAmount},null,8,["modelValue","placeholder"])]),e("div",{class:"foot-btn btn-green g-flex-align-center g-flex-justify-center",onClick:re},l(o(a).betText),1),e("div",{class:"foot-btn btn-red g-flex-align-center g-flex-justify-center",onClick:n[5]||(n[5]=i=>b.value=!b.value)},l(o(a).chips),1),e("div",{class:"foot-btn btn-blue g-flex-align-center g-flex-justify-center",onClick:n[6]||(n[6]=i=>f.value=[])},l(o(a).reset),1),B(e("div",{class:"close g-flex-align-center g-flex-justify-center"},l(o(a).closed),513),[[U,L.value<1]])]),H(De,{ref_key:"refChipPop",ref:F,onLotterySelected:G},null,512)])}}};export{ft as default};
