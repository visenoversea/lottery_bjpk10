import{s as N,u as D,c as O,l as B,k as J,r as f,a as k,P as M,b as U,o,d as r,f as l,e as F,g as a,t as c,j as h,v as d,F as L,h as w,Q as q,z,R as E,T as $,S as Q}from"./index.de11b688.js";import{g as A}from"./index.78e71f9e.js";const G=""+new URL("../img/icon/homepage_icon_star1.png",import.meta.url).href,K=""+new URL("../img/icon/homepage_icon_star2.png",import.meta.url).href;const W={class:"v_main_search g-flex-column"},X={class:"v-main-search-head g-flex-align-center"},Y={class:"v-main-head-search g-flex-align-center"},Z={class:"v-main-search-container"},ee={class:"v-main-search-remeng"},te={class:"v-main-search-remeng-title"},se={class:"v-main-search-remeng-list g-flex-wrap g-flex-align-center"},le=["onClick"],ae={class:"v-main-search-remeng-item g-flex-align-center g-flex-justify-center"},ie={class:"v-main-search-remeng v-main-search-history"},ne={class:"v-main-search-history-title g-flex-justify-between g-flex-align-center"},ce={class:"v-main-search-history-title-left"},oe={class:"v-main-search-remeng-list g-flex-wrap g-flex-align-center"},re=["onClick"],he={class:"v-main-search-remeng-item g-flex-align-center g-flex-justify-center"},de={class:"v-main-search-result"},ge=["onClick"],ue={class:"v-main-search-result-item-left g-flex-align-center"},me={class:"v-main-search-result-item-left-title"},_e={class:"v-main-search-result-item-left-xianshi"},ve=["onClick"],fe={src:G,alt:""},pe={src:K,alt:""},Ce={__name:"MainSearch",setup(xe){const _=N(),P=D(),m=O(()=>P.tm("mainSearch"));B();const T=J();f(""),f(!1);let I=k({list:[]}),v=k({id:"",title:""}),n=k({list:[]});async function p(s){s||(_.loadingShow=!0);const{success:e,data:i}=await q({hot:s?1:"",title:v.title});!e||(s?I.list=i.list:n.list=i.list,console.log(i))}p(!0);function R(s,e){if(!_.token)return T.push({name:"login"});s.isCollected?b(s,e):V(s,e)}async function V(s,e){_.loadingShow=!0;const{success:i,data:t}=await E({id:s.id});!i||($(t.msg),n.list[e].isCollected=1,S(s),console.log(t))}async function b(s,e){_.loadingShow=!0;const{success:i,data:t}=await Q({id:s.id});!i||($(t.msg),n.list[e].isCollected=0,S(s),console.log(t))}function x(s){S(s),T.push({name:"chart",query:{id:s.id}})}let j=localStorage.getItem("localSearchList")?JSON.parse(localStorage.getItem("localSearchList")):[],g=f(j);function S(s){let e=localStorage.getItem("localSearchList")?JSON.parse(localStorage.getItem("localSearchList")):[];console.log("localList",e),e.findIndex(t=>t.id==s.id)==-1&&e.push(s),e=e.slice(0,6),g.value=e,localStorage.setItem("localSearchList",JSON.stringify(e)),console.log("searchHistoryList",g)}function H(){g.value=[],localStorage.removeItem("localSearchList")}let y=f(0);return M(()=>v.title,(s,e)=>{if(!s){clearTimeout(y.value),n.list=[];return}clearTimeout(y.value),y.value=setTimeout(()=>{p(!1)},300)}),(s,e)=>{const i=U("van-search");return o(),r("div",W,[l("div",X,[l("div",Y,[F(i,{class:"v-main-head-vant-search",onSearch:e[0]||(e[0]=t=>p(!1)),modelValue:a(v).title,"onUpdate:modelValue":e[1]||(e[1]=t=>a(v).title=t),placeholder:a(m).searchPlaceholderText},null,8,["modelValue","placeholder"])]),l("div",{onClick:e[2]||(e[2]=t=>s.$router.go(-1)),class:"v-main-search-head-cancel g-flex-align-center"},c(a(m).cancelText),1)]),l("div",Z,[h(l("div",ee,[l("p",te,c(a(m).searchRemengText),1),l("div",se,[(o(!0),r(L,null,w(a(I).list,(t,u)=>(o(),r("div",{onClick:C=>x(t),class:"v-main-search-remeng-item-box",key:u},[l("div",ae,[l("span",null,c(t.title),1)])],8,le))),128))])],512),[[d,!a(n).list.length]]),h(l("div",ie,[h(l("div",ne,[l("p",ce,c(a(m).searchHistoryText),1),h(l("p",{onClick:H,class:"v-main-search-history-title-right"},c(a(m).cleanText),513),[[d,a(g).length]])],512),[[d,a(g).length]]),l("div",oe,[(o(!0),r(L,null,w(a(g),(t,u)=>(o(),r("div",{onClick:C=>x(t),class:"v-main-search-remeng-item-box",key:u},[l("div",he,[l("span",null,c(t.title),1)])],8,re))),128))])],512),[[d,!a(n).list.length]]),h(l("div",de,[(o(!0),r(L,null,w(a(n).list,(t,u)=>(o(),r("div",{onClick:C=>x(t),key:u,class:"v-main-search-result-item g-flex-align-center g-flex-justify-between"},[l("div",ue,[l("div",me,c(t.title),1),l("div",_e,c(a(A)(t.type)),1)]),l("div",{onClick:z(C=>R(t,u),["stop"]),class:"v-main-search-result-item-right g-flex-align-center"},[h(l("img",fe,null,512),[[d,!t.isCollected]]),h(l("img",pe,null,512),[[d,t.isCollected]])],8,ve)],8,ge))),128))],512),[[d,a(n).list.length]])])])}}};export{Ce as default};
