import{e as i,r as Z,o as r,a as u,d as T,j as ae,b as t,K as w,M as L,t as s,O,P as ce,Q as re,u as ue,D as pe,s as de,v as fe,c as N,E as b,S as _e,h as x,U as K,V as c,m as V,p as M,W as ve,X as Q,Y as ge,Z as he,$ as me}from"./main.9a3c90de.js";import{_ as ye}from"./index.4ba18244.js";const xe=""+new URL("../img/chip/clock.png",import.meta.url).href,be=""+new URL("../img/chip/bell.png",import.meta.url).href;const je=j=>(ce("data-v-60b8c17a"),j=j(),re(),j),Ce={class:"s_chip_pop"},$e={class:"s-pop-container g-flex-column"},ke={class:"quick-list"},we=je(()=>t("div",{class:"title"},"\u5207\u6362\u5F69\u79CD",-1)),Le=["onClick"],Se={__name:"ChipPop",emits:["lotterySelected"],setup(j,{expose:S,emit:C}){const I=i([]),P=C,h=i(!1);function p(d){I.value=d,h.value=!0}function m(d){d.status===2?O("\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85\uFF01\uFF01\uFF01"):(P("lotterySelected",d.id),$())}function $(){h.value=!1}return S({onShow:p}),(d,_)=>{const q=Z("van-popup");return r(),u("div",Ce,[T(q,{"safe-area-inset-bottom":"",class:"custom-popup",show:h.value,"onUpdate:show":_[0]||(_[0]=g=>h.value=g),position:"left"},{default:ae(()=>[t("div",$e,[t("div",ke,[we,(r(!0),u(w,null,L(I.value,g=>(r(),u("div",{class:"quick-item",key:`chips${g}`,onClick:U=>m(g)},s(g.lottery_name+" "+g.name),9,Le))),128))])])]),_:1},8,["show"])])}}},Ie=ye(Se,[["__scopeId","data-v-60b8c17a"]]);const De={class:"v_chip g-flex-column"},Ge={class:"v-chip-head"},Oe={class:"v-chip-head-top g-flex-align-center"},Pe=t("i",{class:"iconfont icon-zuojiantou"},null,-1),qe=[Pe],Re={class:"v-chip-head-top-title g-flex-align-center g-flex-justify-center"},Ee=t("i",{class:"iconfont icon-datijilu"},null,-1),He=[Ee],Ne=t("div",{class:"label g-flex-align-center"},"\u5207\u6362\u5F69\u79CD",-1),Ve=t("div",{class:"v-content-right-icon g-flex-align-center"},[t("i",{class:"iconfont icon-you"})],-1),Me=[Ne,Ve],Te=t("div",{class:"lottery-other"},null,-1),Ue={class:"v-chip-info"},We={class:"lottery-data g-flex-align-center"},Ae=t("img",{src:xe,alt:""},null,-1),Be={class:"period"},ze=t("img",{src:be,alt:""},null,-1),Ke={class:"period"},Qe={class:"v-chip-content g-flex"},Ze={class:"play-type"},Fe=["onClick"],Je={class:"type-content"},Xe={class:"content-title g-flex-align-center g-flex-justify-center"},Ye={class:"nums-wrap"},et=["onClick"],tt={class:"rate"},nt={class:"v-chip-footer g-flex-align-center"},ot={class:"quick-list g-flex-align-center"},lt=["onClick"],st={class:"amount"},it={class:"close g-flex-align-center g-flex-justify-center"},ut={__name:"Chip",setup(j){ue();const S=pe(),C=de(),I=fe.exports.useI18n(),P=N(()=>I.tm("chip")),h=i(!1);let p=b({obj:{lottery:{}}});const m=i(),$=i(0);let d=b({id:S.query.id||41,room:S.query.room||1}),_=b({list:[]});function q(e){d.id=e,g()}async function g(){C.loadingShow=!0;const{success:e,data:n}=await ve({id:d.id});if(!!e){if(p.obj=n.info,C.loadingShow=!0,n.info.next.lottery_id){let l={type:2,open_expect:n.info.next.open_expect,content:"",content2:""};_.list.unshift(l)}U(),H()}}g();function U(){Q.joinGroup("lotteryRoom"+d.id,e=>{let n={type:2,open_expect:e.openExpect,content:"",content2:""},l=b({type:3,open_expect:e.openExpect,content:`${P.value.yifengpanText}:`,content2:""});if(e.type==1){let o=e,v=J(e.lotteryPlayed);o.targetObj=v,_.list.unshift(o)}else e.type==2?_.list.unshift(n):e.type==3&&_.list.unshift(l);_.list.length>=1e3&&(_.list=_.list.slice(0,1e3))})}function F(){Q.leaveGroup("lotteryRoom"+d.id)}function J(e){let n=[];p.obj.lotteryGroupList.forEach(o=>{n=n.concat(o.lotteryPlayedList)});let l=n.find(o=>e.id==o.id);return l?Object.assign(l,e):{id:"",name:"",amount:""}}i(!1),i(!1);let D=i(0);i(0),i(0),i(0),i(0),i(""),i(""),i("");let R=b({list:[]}),E=b({obj:{next:{open_expect:"-"}}});const a=N(()=>{if(R.list.length){let e=R.list[0];return e.open_code_arr=e.open_code.split(",").map(n=>Number(n)),e.total=e.open_code_arr.reduce((n,l)=>n+l),e}else return{open_expect:"-",open_code:"",open_code_arr:[],open_time:"",total:0}}),k=i(0),G=i(0);async function H(){const{success:e,data:n}=await ge({id:p.obj.lottery_id});!e||(R.list=n.lotteryDataList.map(l=>(l.open_code_arr=l.open_code.split(",").map(o=>Number(o)),l.total=l.open_code_arr.reduce((o,v)=>o+v),l)),E.obj=n.lottery,k.value=n.lottery.next.open_time-n.nowTime-n.lottery.stop_time,G.value=n.lottery.next.open_time-n.nowTime,X())}function W(e){if(console.log("stamp:"+e),e<1)return"--:--:--";let n=Math.floor(e/3600%24),l=Math.floor(e/60%60),o=Math.floor(e/1%60);return`${n<10?"0"+n:n}:${l<10?"0"+l:l}:${o<10?"0"+o:o}`}let A=i(1);function X(){D.value&&clearInterval(D.value),D.value=setInterval(()=>{A.value++,A.value%5==0&&H(),k.value>0&&k.value--,G.value>0?G.value--:H()},1e3)}let B=i(null);function Y(){B.value.onShow(z.value)}i("ChipCancelPop");const ee=N(()=>f.value.length),f=i([]),te=e=>{if(e===0||e===3||e===6)return"chip-red";if(e===1||e===4||e===7)return"chip-blue";if(e===2||e===5||e===8)return"chip-green"},ne=e=>e<1e3?e:e<1e6?e/1e3+"K":e/1e6+"M",oe=e=>f.value.findIndex(l=>e.id==l.id)!=-1,le=e=>{let n=f.value.findIndex(l=>e.id==l.id);n==-1?f.value.push(e):f.value.splice(n,1),console.log(f.value)},se=async()=>{if(!m.value){O.fail("\u8BF7\u8F93\u5165\u4E0B\u6CE8\u91D1\u989D");return}if(!f.value.length){O.fail("\u8BF7\u9009\u62E9\u4E0B\u6CE8\u53F7\u7801");return}f.value.length&&f.value.forEach(l=>{l.amount=m.value}),C.loadingShow=!0;const{success:e,data:n}=await he({amount:m.value,betList:f.value,id:"41",openExpect:E.obj.next.open_expect});!e||(O.success(n.msg),resetData(),emits("emitDownOrderSuccess"),onClose())},z=i();async function ie(){const{success:e,data:n}=await me({id:d.room});!e||(z.value=n.info)}return ie(),_e(()=>{clearInterval(D.value),F()}),(e,n)=>{const l=Z("van-field");return r(),u("div",De,[t("div",Ge,[t("div",Oe,[t("div",{onClick:n[0]||(n[0]=o=>e.$router.go(-1)),class:"v-chip-head-top-left g-flex-align-center"},qe),t("div",Re,[t("span",null,s(x(p).obj.lottery.name)+" "+s(x(p).obj.name),1)]),t("div",{class:"v-head-right g-flex-align-center",onClick:n[1]||(n[1]=o=>e.$router.push("/mybill"))},He)]),t("div",{class:"lottery-select-wrap g-flex-align-center"},[t("div",{class:"lottery-select g-flex",onClick:Y},Me),Te]),t("div",Ue,[t("div",We,[Ae,t("div",Be,s(x(E).obj.next.open_expect)+"\u671F",1),K(" \u5C01\u76D8\uFF1A"),t("span",null,s(W(k.value)),1),K(" \u5F00\u5956\uFF1A"),t("span",null,s(W(G.value)),1)]),t("div",{class:"lottery-data g-flex-align-center",onClick:n[2]||(n[2]=o=>e.$router.push({path:"/lotteryHistory",query:{id:x(p).obj.lottery_id}}))},[ze,t("div",Ke,s(a.value.open_expect)+"\u671F",1),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[0]}`])},s(a.value.open_code.split(",")[0]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[1]}`])},s(a.value.open_code.split(",")[1]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[2]}`])},s(a.value.open_code.split(",")[2]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[3]}`])},s(a.value.open_code.split(",")[3]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[4]}`])},s(a.value.open_code.split(",")[4]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[5]}`])},s(a.value.open_code.split(",")[5]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[6]}`])},s(a.value.open_code.split(",")[6]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[7]}`])},s(a.value.open_code.split(",")[7]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[8]}`])},s(a.value.open_code.split(",")[8]),3),t("div",{class:c(["number g-flex-align-center g-flex-justify-center",`number${a.value.open_code.split(",")[9]}`])},s(a.value.open_code.split(",")[9]),3)])])]),t("div",Qe,[t("div",Ze,[(r(!0),u(w,null,L(x(p).obj.lotteryGroupList,(o,v)=>(r(),u("div",{class:c(["type-item g-flex-align-center g-flex-justify-center",$.value===v?"active":""]),key:`room${o.id}`,onClick:y=>$.value=v},s(o.name),11,Fe))),128))]),t("div",Je,[(r(!0),u(w,null,L(x(p).obj.lotteryGroupList,(o,v)=>V((r(),u("div",{class:"content-item",key:`type${o.id}`},[t("div",Xe,s(o.name),1),t("div",Ye,[(r(!0),u(w,null,L(o.lotteryPlayedList,y=>(r(),u("div",{class:c(["num-item g-flex-align-center g-flex-justify-center",oe(y)?"active":""]),key:`num${y.id}`,onClick:at=>le(y)},[t("div",{class:c(["num g-flex-align-center g-flex-justify-center",`number${y.name}`])},s(y.name),3),t("div",tt,s(y.odds),1)],10,et))),128))])])),[[M,$.value===v]])),128))])]),t("div",nt,[V(t("div",ot,[(r(!0),u(w,null,L(x(p).obj.quickList,(o,v)=>(r(),u("div",{class:c([te(v),"quick-item g-flex-align-center g-flex-justify-center"]),key:`chips${o}`,onClick:y=>m.value=o},s(ne(o)),11,lt))),128))],512),[[M,h.value]]),t("div",st,[t("p",null,"\u5DF2\u9009\u4E2D"+s(ee.value)+"\u6CE8",1),T(l,{class:"chip-amount",modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=o=>m.value=o),label:"","label-width":"0",placeholder:"\u8BF7\u8F93\u5165\u91D1\u989D"},null,8,["modelValue"])]),t("div",{class:"foot-btn btn-green g-flex-align-center g-flex-justify-center",onClick:se}," \u4E0B\u6CE8 "),t("div",{class:"foot-btn btn-red g-flex-align-center g-flex-justify-center",onClick:n[4]||(n[4]=o=>h.value=!h.value)}," \u7B79\u7801 "),t("div",{class:"foot-btn btn-blue g-flex-align-center g-flex-justify-center",onClick:n[5]||(n[5]=o=>f.value=[])}," \u91CD\u7F6E "),V(t("div",it," \u5DF2\u5C01\u76D8 ",512),[[M,k.value<1]])]),T(Ie,{ref_key:"refChipPop",ref:B,onLotterySelected:q},null,512)])}}};export{ut as default};
