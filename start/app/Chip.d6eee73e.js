import{e as a,v as X,r as Y,o as v,a as f,d as A,j as ue,b as e,t as l,h as g,K as S,M as D,U as E,u as pe,D as de,s as ve,c as T,E as C,V as fe,W as F,X as r,m as U,p as W,Y as _e,Z as J,$ as ge,a0 as me,P as he,a1 as ye,a2 as Q}from"./main.57596d9d.js";import{_ as xe}from"./index.14f39fca.js";const be=""+new URL("../img/chip/clock.png",import.meta.url).href,je=""+new URL("../img/chip/bell.png",import.meta.url).href;const Ce={class:"s_chip_pop"},$e={class:"s-pop-container g-flex-column"},ke={class:"quick-list"},we={class:"title"},Le=["onClick"],Ie={__name:"ChipPop",emits:["lotterySelected"],setup(ee,{expose:P,emit:$}){const G=a([]),c=$,k=X.exports.useI18n(),u=computed(()=>k.tm("chip")),p=a(!1);function w(b){G.value=b,p.value=!0}function m(b){b.status===2?E(u.value.noOpen):(c("lotterySelected",b.id),h())}function h(){p.value=!1}return P({onShow:w}),(b,L)=>{const H=Y("van-popup");return v(),f("div",Ce,[A(H,{"safe-area-inset-bottom":"",class:"custom-popup",show:p.value,"onUpdate:show":L[0]||(L[0]=y=>p.value=y),position:"left"},{default:ue(()=>[e("div",$e,[e("div",ke,[e("div",we,l(g(u).switch),1),(v(!0),f(S,null,D(G.value,y=>(v(),f("div",{class:"quick-item",key:`chips${y}`,onClick:B=>m(y)},l(y.lottery_name+" "+y.name),9,Le))),128))])])]),_:1},8,["show"])])}}},Se=xe(Ie,[["__scopeId","data-v-6333222a"]]);const De={class:"v_chip g-flex-column"},Pe={class:"v-chip-head"},Ge={class:"v-chip-head-top g-flex-align-center"},Oe=e("i",{class:"iconfont icon-zuojiantou"},null,-1),qe=[Oe],Re={class:"v-chip-head-top-title g-flex-align-center g-flex-justify-center"},Ee=e("i",{class:"iconfont icon-datijilu"},null,-1),He=[Ee],Ne={class:"lottery-select-wrap g-flex-align-center g-flex-justify-between"},Ve={class:"label g-flex-align-center"},Te=e("div",{class:"v-content-right-icon g-flex-align-center"},[e("i",{class:"iconfont icon-you"})],-1),Ue={class:"bet-info g-flex"},We={class:"bet-info-item"},Ae={class:"bet-info-item"},Be={class:"bet-info-item"},Me={class:"v-chip-info"},ze={class:"lottery-data g-flex-align-center"},Ke=e("img",{src:be,alt:""},null,-1),Ze={class:"period"},Fe=e("img",{src:je,alt:""},null,-1),Je={class:"period"},Qe={class:"v-chip-content g-flex"},Xe={class:"play-type"},Ye=["onClick"],et={class:"type-content"},tt={class:"content-title g-flex-align-center g-flex-justify-center"},nt={class:"nums-wrap"},lt=["onClick"],ot={class:"rate"},st={class:"v-chip-footer g-flex-align-center"},it={class:"quick-list g-flex-align-center"},at=["onClick"],ct={class:"amount"},dt={__name:"Chip",setup(ee){pe();const P=de(),$=ve(),G=X.exports.useI18n(),c=T(()=>G.tm("chip")),k=a(!1);let u=C({obj:{lottery:{}}});a();const p=a(),w=a(0);let m=C({id:P.query.id,room:P.query.room}),h=C({list:[]});function b(t){m.id=t,L()}async function L(){$.loadingShow=!0;const{success:t,data:n}=await _e({id:m.id});if(!!t){if(u.obj=n.info,$.loadingShow=!0,n.info.next.lottery_id){let s={type:2,open_expect:n.info.next.open_expect,content:"",content2:""};h.list.unshift(s)}H(),V()}}L();function H(){J.joinGroup("lotteryRoom"+m.id,t=>{let n={type:2,open_expect:t.openExpect,content:"",content2:""},s=C({type:3,open_expect:t.openExpect,content:`${c.value.yifengpanText}:`,content2:""});if(t.type==1){let o=t,_=B(t.lotteryPlayed);o.targetObj=_,h.list.unshift(o)}else t.type==2?h.list.unshift(n):t.type==3&&h.list.unshift(s);h.list.length>=1e3&&(h.list=h.list.slice(0,1e3))})}function y(){J.leaveGroup("lotteryRoom"+m.id)}function B(t){let n=[];u.obj.lotteryGroupList.forEach(o=>{n=n.concat(o.lotteryPlayedList)});let s=n.find(o=>t.id==o.id);return s?Object.assign(s,t):{id:"",name:"",amount:""}}a(!1),a(!1);let O=a(0),N=C({list:[]}),j=C({obj:{next:{open_expect:"-"}}});const i=T(()=>{if(N.list.length){let t=N.list[0];return t.open_code_arr=t.open_code.split(",").map(n=>Number(n)),t.total=t.open_code_arr.reduce((n,s)=>n+s),t}else return{open_expect:"-",open_code:"",open_code_arr:[],open_time:"",total:0}}),I=a(0),q=a(0);async function V(){const{success:t,data:n}=await ge({id:u.obj.lottery_id});!t||(N.list=n.lotteryDataList.map(s=>(s.open_code_arr=s.open_code.split(",").map(o=>Number(o)),s.total=s.open_code_arr.reduce((o,_)=>o+_),s)),(j.obj.next.open_expect==="-"||j.obj.next.open_expect!==n.lottery.next.open_expect)&&Z(n.lottery.next.open_expect),j.obj=n.lottery,I.value=n.lottery.next.open_time-n.nowTime-n.lottery.stop_time,q.value=n.lottery.next.open_time-n.nowTime,te())}let M=a(1);function te(){O.value&&clearInterval(O.value),O.value=setInterval(()=>{M.value++,M.value%5==0&&V(),I.value>0&&I.value--,q.value>0?q.value--:V()},1e3)}let z=a(null);function ne(){z.value.onShow(K.value)}a("ChipCancelPop");const le=T(()=>d.value.length),d=a([]),oe=t=>{if(t===0||t===3||t===6)return"chip-red";if(t===1||t===4||t===7)return"chip-blue";if(t===2||t===5||t===8)return"chip-green"},se=t=>t<1e3?t:t<1e6?t/1e3+"K":t/1e6+"M",ie=t=>d.value.findIndex(s=>t.id==s.id)!=-1,ae=t=>{let n=d.value.findIndex(s=>t.id==s.id);n==-1?d.value.push(t):d.value.splice(n,1),console.log(d.value)},ce=async()=>{if(!p.value){E.fail(c.value.amountPlaceholder);return}if(!d.value.length){E.fail(c.value.betsPlaceholder);return}d.value.length&&d.value.forEach(s=>{s.amount=p.value}),$.loadingShow=!0;const{success:t,data:n}=await me({amount:p.value,betList:d.value,id:m.id,openExpect:j.obj.next.open_expect});!t||(E.success(n.msg),Z(),p.value="",d.value=[],resetData(),emits("emitDownOrderSuccess"),onClose())},K=a();async function re(){const{success:t,data:n}=await he({id:m.room});!t||(K.value=n.info)}re();const R=a({}),Z=async t=>{const{success:n,data:s}=await ye({id:m.id,lottery_expect:t||j.obj.next.open_expect});!n||(R.value=s.info)};return fe(()=>{clearInterval(O.value),y()}),(t,n)=>{const s=Y("van-field");return v(),f("div",De,[e("div",Pe,[e("div",Ge,[e("div",{onClick:n[0]||(n[0]=o=>t.$router.go(-1)),class:"v-chip-head-top-left g-flex-align-center"},qe),e("div",Re,[e("span",null,l(g(u).obj.lottery.name)+" "+l(g(u).obj.name),1)]),e("div",{class:"v-head-right g-flex-align-center",onClick:n[1]||(n[1]=o=>t.$router.push("/mybill"))},He)]),e("div",Ne,[e("div",{class:"lottery-select g-flex",onClick:ne},[e("div",Ve,l(c.value.switch),1),Te]),e("div",Ue,[e("div",We,[e("label",null,l(c.value.balance),1),e("p",null,l(R.value.balance),1)]),e("div",Ae,[e("label",null,l(c.value.betAmount),1),e("p",null,l(R.value.betAmount),1)]),e("div",Be,[e("label",null,l(c.value.todayWin),1),e("p",null,l(R.value.todayWin),1)])])]),e("div",Me,[e("div",ze,[Ke,e("div",Ze,l(g(j).obj.next.open_expect)+l(c.value.expect),1),F(" "+l(c.value.close)+" ",1),e("span",null,l(g(Q)(I.value)),1),F(" "+l(c.value.open)+" ",1),e("span",null,l(g(Q)(q.value)),1)]),e("div",{class:"lottery-data g-flex-align-center",onClick:n[2]||(n[2]=o=>t.$router.push({path:"/lotteryHistory",query:{id:g(u).obj.lottery_id}}))},[Fe,e("div",Je,l(i.value.open_expect)+l(c.value.expect),1),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[0]}`])},l(i.value.open_code.split(",")[0]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[1]}`])},l(i.value.open_code.split(",")[1]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[2]}`])},l(i.value.open_code.split(",")[2]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[3]}`])},l(i.value.open_code.split(",")[3]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[4]}`])},l(i.value.open_code.split(",")[4]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[5]}`])},l(i.value.open_code.split(",")[5]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[6]}`])},l(i.value.open_code.split(",")[6]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[7]}`])},l(i.value.open_code.split(",")[7]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[8]}`])},l(i.value.open_code.split(",")[8]),3),e("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${i.value.open_code.split(",")[9]}`])},l(i.value.open_code.split(",")[9]),3)])])]),e("div",Qe,[e("div",Xe,[(v(!0),f(S,null,D(g(u).obj.lotteryGroupList,(o,_)=>(v(),f("div",{class:r(["type-item g-flex-align-center g-flex-justify-center",w.value===_?"active":""]),key:`room${o.id}`,onClick:x=>w.value=_},l(o.name),11,Ye))),128))]),e("div",et,[(v(!0),f(S,null,D(g(u).obj.lotteryGroupList,(o,_)=>U((v(),f("div",{class:"content-item",key:`type${o.id}`},[e("div",tt,l(o.name),1),e("div",nt,[(v(!0),f(S,null,D(o.lotteryPlayedList,x=>(v(),f("div",{class:r(["num-item g-flex-align-center g-flex-justify-center",ie(x)?"active":""]),key:`num${x.id}`,onClick:rt=>ae(x)},[e("div",{class:r(["num g-flex-align-center g-flex-justify-center",`number${x.name}`])},l(x.name),3),e("div",ot,l(x.odds),1)],10,lt))),128))])])),[[W,w.value===_]])),128))])]),e("div",st,[U(e("div",it,[(v(!0),f(S,null,D(g(u).obj.quickList,(o,_)=>(v(),f("div",{class:r([oe(_),"quick-item g-flex-align-center g-flex-justify-center"]),key:`chips${o}`,onClick:x=>p.value=o},l(se(o)),11,at))),128))],512),[[W,k.value]]),e("div",ct,[e("p",null,"\u5DF2\u9009\u4E2D"+l(le.value)+"\u6CE8",1),A(s,{class:"chip-amount",modelValue:p.value,"onUpdate:modelValue":n[3]||(n[3]=o=>p.value=o),label:"","label-width":"0",placeholder:"\u8BF7\u8F93\u5165\u91D1\u989D"},null,8,["modelValue"])]),e("div",{class:"foot-btn btn-green g-flex-align-center g-flex-justify-center",onClick:ce}," \u4E0B\u6CE8 "),e("div",{class:"foot-btn btn-red g-flex-align-center g-flex-justify-center",onClick:n[4]||(n[4]=o=>k.value=!k.value)},l(c.value.chips),1),e("div",{class:"foot-btn btn-blue g-flex-align-center g-flex-justify-center",onClick:n[5]||(n[5]=o=>d.value=[])},l(c.value.reset),1),U(e("div",{class:"close g-flex-align-center g-flex-justify-center"},l(c.value.closed),513),[[W,I.value<1]])]),A(Se,{ref_key:"refChipPop",ref:z,onLotterySelected:b},null,512)])}}};export{dt as default};
