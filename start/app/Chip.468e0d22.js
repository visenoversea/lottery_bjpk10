import{u as le,D as ne,s as oe,v as se,c as H,e as i,E as $,O as ae,r as ie,o as v,a as d,b as t,t as a,h as p,P as re,Q as r,K as w,M as L,m as P,p as U,d as ue,S as ce,W as q,U as pe,V as E,X as ve}from"./main.26c763da.js";const de=""+new URL("../img/chip/clock.png",import.meta.url).href,fe=""+new URL("../img/chip/bell.png",import.meta.url).href;const _e={class:"v_chip g-flex-column"},ge={class:"v-chip-head"},me={class:"v-chip-head-top g-flex-align-center"},he=t("i",{class:"iconfont icon-zuojiantou"},null,-1),ye=[he],xe={class:"v-chip-head-top-title g-flex-align-center g-flex-justify-center"},be={class:"v-chip-info"},je={class:"lottery-data g-flex-align-center"},Ce=t("img",{src:de,alt:""},null,-1),$e={class:"period"},ke=t("img",{src:fe,alt:""},null,-1),we={class:"period"},Le={class:"v-chip-content g-flex"},Ie={class:"play-type"},De=["onClick"],Ge={class:"type-content"},Oe={class:"content-title g-flex-align-center g-flex-justify-center"},Se={class:"nums-wrap"},Ne=["onClick"],Re={class:"rate"},Te={class:"v-chip-footer g-flex-align-center"},He={class:"quick-list g-flex-align-center"},Ee=["onClick"],Ve={class:"amount"},qe={__name:"Chip",setup(Me){le(),ne();const I=oe(),W=se.exports.useI18n(),z=H(()=>W.tm("chip")),D=i(!1);let f=$({obj:{lottery:{}}});const b=i(),G=i(0);let O=$({id:"41"}),x=$({list:[]});async function A(){I.loadingShow=!0;const{success:e,data:l}=await ce({id:O.id});if(!!e){if(f.obj=l.info,I.loadingShow=!0,l.info.next.lottery_id){let o={type:2,open_expect:l.info.next.open_expect,content:"",content2:""};x.list.unshift(o)}B(),T()}}A();function B(){q.joinGroup("lotteryRoom"+O.id,e=>{let l={type:2,open_expect:e.openExpect,content:"",content2:""},o=$({type:3,open_expect:e.openExpect,content:`${z.value.yifengpanText}:`,content2:""});if(e.type==1){let n=e,c=F(e.lotteryPlayed);n.targetObj=c,x.list.unshift(n)}else e.type==2?x.list.unshift(l):e.type==3&&x.list.unshift(o);x.list.length>=1e3&&(x.list=x.list.slice(0,1e3))})}function K(){q.leaveGroup("lotteryRoom"+O.id)}function F(e){let l=[];f.obj.lotteryGroupList.forEach(n=>{l=l.concat(n.lotteryPlayedList)});let o=l.find(n=>e.id==n.id);return o?Object.assign(o,e):{id:"",name:"",amount:""}}i(!1),i(!1);let j=i(0),S=i(0),_=i(0),k=i(0),C=i(0),g=i(""),m=i(""),h=i(""),N=$({list:[]}),R=$({obj:{next:{open_expect:"-"}}});const s=H(()=>{if(N.list.length){let e=N.list[0];return e.open_code_arr=e.open_code.split(",").map(l=>Number(l)),e.total=e.open_code_arr.reduce((l,o)=>l+o),e}else return{open_expect:"-",open_code:"",open_code_arr:[],open_time:"",total:0}});async function T(){const{success:e,data:l}=await pe({id:f.obj.lottery_id});!e||(N.list=l.lotteryDataList.map(o=>(o.open_code_arr=o.open_code.split(",").map(n=>Number(n)),o.total=o.open_code_arr.reduce((n,c)=>n+c),o)),R.obj=l.lottery,S.value=l.lottery.stop_time*1e3,k.value=l.nowTime*1e3,_.value=Number(l.lottery.next.open_time*1e3)-Number(S.value),C.value=_.value-k.value,V(),_.value=_.value-1e3,J(),apiGetUserInfoHandel())}function V(){g.value=Math.floor(C.value/36e5%24),m.value=Math.floor(C.value/6e4%60),h.value=Math.floor(C.value/1e3%60),g.value=g.value<10?"0"+g.value:g.value,m.value=m.value<10?"0"+m.value:m.value,h.value=h.value<10?"0"+h.value:h.value}let M=i(1);function J(){j.value&&clearInterval(j.value),j.value=setInterval(()=>{M.value++,M.value%5==0&&T(),_.value?(C.value=_.value-k.value,C.value>0?(V(),_.value=_.value-1e3):(g.value=m.value=h.value="-",clearInterval(j.value),setTimeout(()=>{T()},S.value))):(g.value=m.value=h.value="-",clearInterval(j.value))},1e3)}i(null),i("ChipCancelPop");const Q=H(()=>u.value.length),u=i([]),X=e=>{if(e===0||e===3||e===6)return"chip-red";if(e===1||e===4||e===7)return"chip-blue";if(e===2||e===5||e===8)return"chip-green"},Z=e=>e<1e3?e:e<1e6?e/1e3+"K":e/1e6+"M",Y=e=>u.value.findIndex(o=>e.id==o.id)!=-1,ee=e=>{let l=u.value.findIndex(o=>e.id==o.id);l==-1?u.value.push(e):u.value.splice(l,1),console.log(u.value)},te=async()=>{if(!b.value){E.fail("\u8BF7\u8F93\u5165\u4E0B\u6CE8\u91D1\u989D");return}if(!u.value.length){E.fail("\u8BF7\u9009\u62E9\u4E0B\u6CE8\u53F7\u7801");return}u.value.length&&u.value.forEach(o=>{o.amount=b.value}),I.loadingShow=!0;const{success:e,data:l}=await ve({amount:b.value,betList:u.value,id:"41",openExpect:R.obj.next.open_expect});!e||(E.success(l.msg),resetData(),emits("emitDownOrderSuccess"),onClose())};return ae(()=>{clearInterval(j.value),K()}),(e,l)=>{const o=ie("van-field");return v(),d("div",_e,[t("div",ge,[t("div",me,[t("div",{onClick:l[0]||(l[0]=n=>e.$router.go(-1)),class:"v-chip-head-top-left g-flex-align-center"},ye),t("div",xe,[t("span",null,a(p(f).obj.lottery.name)+" "+a(p(f).obj.name),1)])]),t("div",be,[t("div",je,[Ce,t("div",$e,a(p(R).obj.next.open_expect)+"\u671F",1),re(" \u5F00\u76D8\uFF1A"),t("span",null,a(p(k)?p(g)+":"+p(m)+":"+p(h):"--:--:--"),1)]),t("div",{class:"lottery-data g-flex-align-center",onClick:l[1]||(l[1]=n=>e.$router.push("/lotteryHistory"))},[ke,t("div",we,a(s.value.open_expect)+"\u671F",1),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[0]}`])},a(s.value.open_code.split(",")[0]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[1]}`])},a(s.value.open_code.split(",")[1]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[2]}`])},a(s.value.open_code.split(",")[2]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[3]}`])},a(s.value.open_code.split(",")[3]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[4]}`])},a(s.value.open_code.split(",")[4]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[5]}`])},a(s.value.open_code.split(",")[5]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[6]}`])},a(s.value.open_code.split(",")[6]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[7]}`])},a(s.value.open_code.split(",")[7]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[8]}`])},a(s.value.open_code.split(",")[8]),3),t("div",{class:r(["number g-flex-align-center g-flex-justify-center",`number${s.value.open_code.split(",")[9]}`])},a(s.value.open_code.split(",")[9]),3)])])]),t("div",Le,[t("div",Ie,[(v(!0),d(w,null,L(p(f).obj.lotteryGroupList,(n,c)=>(v(),d("div",{class:r(["type-item g-flex-align-center g-flex-justify-center",G.value===c?"active":""]),key:`room${n.id}`,onClick:y=>G.value=c},a(n.name),11,De))),128))]),t("div",Ge,[(v(!0),d(w,null,L(p(f).obj.lotteryGroupList,(n,c)=>P((v(),d("div",{class:"content-item",key:`type${n.id}`},[t("div",Oe,a(n.name),1),t("div",Se,[(v(!0),d(w,null,L(n.lotteryPlayedList,y=>(v(),d("div",{class:r(["num-item g-flex-align-center g-flex-justify-center",Y(y)?"active":""]),key:`num${y.id}`,onClick:Pe=>ee(y)},[t("div",{class:r(["num g-flex-align-center g-flex-justify-center",`number${y.name}`])},a(y.name),3),t("div",Re,a(y.odds),1)],10,Ne))),128))])])),[[U,G.value===c]])),128))])]),t("div",Te,[P(t("div",He,[(v(!0),d(w,null,L(p(f).obj.quickList,(n,c)=>(v(),d("div",{class:r([X(c),"quick-item g-flex-align-center g-flex-justify-center"]),key:`chips${n}`,onClick:y=>b.value=n},a(Z(n)),11,Ee))),128))],512),[[U,D.value]]),t("div",Ve,[t("p",null,"\u5DF2\u9009\u4E2D"+a(Q.value)+"\u6CE8",1),ue(o,{class:"chip-amount",modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=n=>b.value=n),label:"","label-width":"0",placeholder:"\u8BF7\u8F93\u5165\u91D1\u989D"},null,8,["modelValue"])]),t("div",{class:"foot-btn btn-green g-flex-align-center g-flex-justify-center",onClick:te}," \u4E0B\u6CE8 "),t("div",{class:"foot-btn btn-red g-flex-align-center g-flex-justify-center",onClick:l[3]||(l[3]=n=>D.value=!D.value)}," \u7B79\u7801 "),t("div",{class:"foot-btn btn-blue g-flex-align-center g-flex-justify-center",onClick:l[4]||(l[4]=n=>u.value=[])}," \u91CD\u7F6E ")])])}}};export{qe as default};
